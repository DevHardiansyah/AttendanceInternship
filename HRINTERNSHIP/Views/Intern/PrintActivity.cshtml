@model List<HRINTERNSHIP.Models.Intern_AttendanceNew>
@{
    string dateSend = DateTime.Now.ToString("MMddyyyyhhmmsstt");
    ViewBag.Title = "Attendance Report " + @Session["user"].ToString().ToUpper() + dateSend + "";
    Layout = "~/Views/Shared/_LockerPrint.cshtml";
}
<style>
    body {
        margin: 5mm 5mm 5mm 5mm;
        size: A4;
    }

    img {
        margin: 20px;
        transition: all 400ms;
    }

    /* or use CSS */
    .rotate90 {
        -webkit-transform: rotate(90deg);
        -moz-transform: rotate(90deg);
        -o-transform: rotate(90deg);
        -ms-transform: rotate(90deg);
        transform: rotate(90deg);
    }
</style>
<div class="row">
    @*@{
        if (ViewBag.StatusApproved == "Approved")
        {
        <p>
        <img src="~/Content/images/icon/approved2.png" style="position: absolute; top: 260px; right: 160px; opacity: 0.1;
        z-index: 0; color: white; text-align: center; margin: 5mm 5mm 5mm 5mm" data-rotate="-30" />
        </p>z
        }
        else if (ViewBag.StatusApproved == "Waiting For Approval Manager")
        {
        <p>
        <img src="~/Content/images/icon/pending.png" style="position: absolute; top: 260px; right: 160px; opacity: 0.1;
        z-index: 0; color: white; text-align: center; margin: 5mm 5mm 5mm 5mm" data-rotate="-30" />
        </p>
        }
        else if (ViewBag.StatusApproved == "Rejected By Manager")
        {
        <p>
        <img src="~/Content/images/icon/rejected.png" style="position: absolute; top: 260px; right: 160px; opacity: 0.1;
        z-index: 0; color: white; text-align: center; margin: 5mm 5mm 5mm 5mm" data-rotate="-30" />
        </p>
        }
        else if (ViewBag.StatusApproved == "Rejected By Mentor")
        {
        <p>
        <img src="~/Content/images/icon/rejected.png" style="position: absolute; top: 260px; right: 160px; opacity: 0.1;
        z-index: 0; color: white; text-align: center; margin: 5mm 5mm 5mm 5mm" data-rotate="-30" />
        </p>
        }
        else
        {
        <p></p>
        }
        }*@
    @*<p>
        <img src="~/Content/images/icon/approved2.png" style="position: absolute; top: 260px; right: 160px; opacity: 0.1;
        z-index: 0; color: white; text-align: center; margin: 5mm 5mm 5mm 5mm" data-rotate="-30" />
    </p>*@
    <div class="col-md-12" id="attendancereport">
        <div>
            <div>
                <div>
                    <div class="text-center row mt-5 mb-2">
                        <div class="col-2 mb-2 mt-2" style="margin-left:100px;">
                            <img align="center" border="0" class="center fixedwidth"
                                 src="~/Content/images/Mattel_logo.png"
                                 style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: 0; width: 100%; max-width: 70px; display: block;"
                                 width="44">
                        </div>
                        <div style="color:#555555;font-family:Arial, Helvetica Neue, Helvetica, sans-serif;line-height:1.2;padding-top:15px;padding-right:0px;padding-bottom:0px;padding-left:0px; margin-left:-170px"
                             class="col-8">
                            <div class="txtTinyMce-wrapper"
                                 style="line-height: 1.2; font-size: 12px; color: #555555; font-family: Arial, Helvetica Neue, Helvetica, sans-serif; mso-line-height-alt: 14px;">
                                <p style="margin: 0; font-size: 33px; line-height: 1.2; word-break: break-word; text-align: center; mso-line-height-alt: 26px; margin-top: 0; margin-bottom: 0;">
                                    <span style="font-size: 44px;">Attendance Report</span>
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <table align="center" width="90%" style="font-size:22px;">
                            <tr class="text-left mt-2 mb-2" style="height:45px;">
                                <td width="25%">Name</td>
                                <td>:</td>
                                <td>@Session["user"].ToString().ToUpper()</td>
                            </tr>
                            <tr class="text-left mb-2" style="height:45px;">
                                <td>University</td>
                                <td>:</td>
                                <td>@Session["university"].ToString().ToUpper()</td>
                            </tr>
                            <tr class="text-left mt-5" style="height:45px;">
                                <td>Month</td>
                                <td>:</td>
                                <td>@ViewBag.From - @ViewBag.To</td>
                            </tr>
                            <tr class="text-left mt-5" style="height:45px;">
                                <td>Supervisor/Manager</td>
                                <td>:</td>
                                <td>@Session["namementor"].ToString() / @Session["namemanager"].ToString()</td>
                            </tr>
                            <tr class="text-left mt-5" style="height:45px;">
                                <td>Area/Department</td>
                                <td>:</td>
                                <td>@Session["isect"].ToString() / @Session["idept"].ToString()</td>
                            </tr>
                        </table>
                        <br><br>
                        <table align="center" width="90%" border="1" style="font-size: 22px;">
                            <tr class="text-center mt-2" style="border: 10px #000; height: 75px;">
                                <td width="5%"><b>No</b></td>
                                <td><b>Task/Assigments</b></td>
                                <td><b>Date</b></td>
                            </tr>
                            @{
                                int counter = 0;
                                foreach (var item in Model)
                                {
                                    counter = counter + 1;
                                    <tr class="text-center mt-5"
                                        style="height: 10px; height: 90px; width: 30px; border: 10px #000; text-align: center;">
                                        <td class="p-1">
                                            <span style="float: left; margin-left: 5px; margin-top: -40px;">@counter</span>
                                        </td>
                                        <td class="text-justify p-1">
                                            <span style="float: left; margin-left: 5px; margin-top: auto;">@item.Activity</span>
                                        </td>
                                        <td class="p-1">@Convert.ToDateTime(item.test).ToString("MM/dd/yyyy")</td>
                                    </tr>
                                }
                            }
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        @*window.onload = function () {
            const invoice = this.document.getElementById("attendancereport");
            console.log(invoice);
            console.log(window);
            var opt = {
                margin: 0,1,
                filename: '@Session["user"].ToString().ToUpper() @ViewBag.From - @ViewBag.To .pdf',
                image: { type: 'jpeg', quality: 1 },
                html2canvas: { scale: 1 },
                jsPDF: { unit: 'in', format: 'A4', orientation: 'portrait' }
            };
            html2pdf().from(invoice).set(opt).save();
        }*@
        window.print();
        $('img').each(function () {
            var deg = $(this).data('rotate') || 0;
            var rotate = 'rotate(' + $(this).data('rotate') + 'deg)';
            $(this).css({
                '-webkit-transform': rotate,
                '-moz-transform': rotate,
                '-o-transform': rotate,
                '-ms-transform': rotate,
                'transform': rotate
            });
        });
    </script>
